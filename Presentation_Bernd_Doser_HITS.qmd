---
title: Spherinator & HiPSter
author: Bernd Doser
date: 2024/05/07
date-format: "MMMM YYYY"
institute: "[HITS gGmbH](https://h-its.org)"
title-slide-attributes:
  data-background-image: images/SPACE_title_slide.png
  data-background-size: contain
format:
  revealjs:
    logo: images/HITS_RGB_eng.jpg
    footer: "Spherinator & HiPSter (B. Doser)"
    slide-number: true
    highlight-style: a11y
    bibliography: references.bib
  pptx:
    reference-doc: Space_template_v04_20240216.pptx
---

## Agenda

- Development environment
- Spherinator: Model training
- Lightning CLI
- HiPSter: Inference


## Development Environment

- Open source at GitHub
- Python dependency management with `Poetry`
- Automated dependency updates with `Dependabot`
  - Pull request for each update


## Model Training

- PyTorch Lightning
- Monitoring with `Weights&Biases`
  - Sharing results, reports and models within resarch group


## Spherinator: Euclidean vs (Hyper-)spherical

Euclidean latent spaces -> Gaussian reference distribution

Hyperspherical latent spaces [@DeCao2020] -> Uniform reference distribution

Kullback-Leibler divergence

$$\begin{aligned}
L = L_{recon} + \lambda \cdot L_{KL}
\end{aligned}$$

For visualization dim = 3 -> 


## PyTorch Lightning CLI

- ML training (experiment) defined in a single yaml file

```yaml
{{< include _illustris_power_simplified.yaml >}}
```


## Spherinator: Step by Step

- Clone repository
```
git clone https://github.com/HITS-AIN/Spherinator.git [--branch v0.2]
```
- Install all dependencies and change into virtual environment
```
poetry install
poetry shell
```
- Start training with 
```
spherinator.py fit -c config.yaml
```


## HiPSter Workflow

- Python workflow for inference
![](images/HiPSter.drawio.svg)


## Acknowledgement & Disclaimer

![](images/SPACE_acknowledgement_cutout.png){.nostretch width="1050"}


## References
